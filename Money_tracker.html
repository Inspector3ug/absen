<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Personal Money Tracker</title>
    <style>
        :root {
            --primary-color: #4a6fa5;
            --secondary-color: #166088;
            --income-color: #4caf50;
            --expense-color: #f44336;
            --light-bg: #f5f5f5;
            --border-color: #ddd;
        }
        
        * {
            box-sizing: border-box;
            margin: 0;
            padding: 0;
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
        }
        
        body {
            background-color: var(--light-bg);
            padding: 20px;
            color: #333;
        }
        
        .container {
            max-width: 1000px;
            margin: 0 auto;
            background-color: white;
            border-radius: 8px;
            box-shadow: 0 2px 10px rgba(0, 0, 0, 0.1);
            padding: 20px;
        }
        
        header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 20px;
            padding-bottom: 15px;
            border-bottom: 1px solid var(--border-color);
        }
        
        h1 {
            color: var(--primary-color);
        }
        
        .summary-cards {
            display: flex;
            gap: 15px;
            margin-bottom: 20px;
        }
        
        .card {
            flex: 1;
            padding: 15px;
            border-radius: 8px;
            box-shadow: 0 2px 5px rgba(0, 0, 0, 0.1);
            text-align: center;
        }
        
        .card h3 {
            margin-bottom: 10px;
            font-size: 0.9rem;
            color: #666;
        }
        
        .card p {
            font-size: 1.5rem;
            font-weight: bold;
        }
        
        .balance {
            background-color: #e8f4fd;
            color: var(--primary-color);
        }
        
        .income {
            background-color: #e8f5e9;
            color: var(--income-color);
        }
        
        .expense {
            background-color: #ffebee;
            color: var(--expense-color);
        }
        
        .form-section {
            background-color: #f9f9f9;
            padding: 15px;
            border-radius: 8px;
            margin-bottom: 20px;
        }
        
        .form-row {
            display: flex;
            flex-wrap: wrap;
            gap: 10px;
            margin-bottom: 10px;
        }
        
        .form-group {
            flex: 1;
            min-width: 150px;
        }
        
        label {
            display: block;
            margin-bottom: 5px;
            font-weight: 500;
        }
        
        input, select {
            width: 100%;
            padding: 8px;
            border: 1px solid var(--border-color);
            border-radius: 4px;
        }
        
        button {
            padding: 10px 15px;
            background-color: var(--primary-color);
            color: white;
            border: none;
            border-radius: 4px;
            cursor: pointer;
            transition: background-color 0.3s;
        }
        
        button:hover {
            background-color: var(--secondary-color);
        }
        
        .actions {
            display: flex;
            gap: 10px;
            margin-top: 15px;
        }
        
        .export-btn {
            background-color: #28a745;
        }
        
        .import-btn {
            background-color: #ffc107;
            color: #333;
        }
        
        .clear-btn {
            background-color: #dc3545;
        }
        
        table {
            width: 100%;
            border-collapse: collapse;
            margin-top: 20px;
        }
        
        th, td {
            padding: 12px 15px;
            text-align: left;
            border-bottom: 1px solid var(--border-color);
        }
        
        th {
            background-color: #f2f2f2;
            font-weight: 600;
        }
        
        .type-in {
            color: var(--income-color);
            font-weight: bold;
        }
        
        .type-out {
            color: var(--expense-color);
            font-weight: bold;
        }
        
        .delete-btn {
            background-color: transparent;
            color: #dc3545;
            padding: 5px 10px;
            font-size: 0.8rem;
        }
        
        .no-data {
            text-align: center;
            padding: 20px;
            color: #666;
        }
        
        @media (max-width: 768px) {
            .summary-cards {
                flex-direction: column;
            }
            
            .form-row {
                flex-direction: column;
            }
        }
    </style>
</head>
<body>
    <div class="container">
        <header>
            <h1>Personal Money Tracker</h1>
            <div class="actions">
                <button id="exportBtn" class="export-btn">Export Data</button>
                <button id="importBtn" class="import-btn">Import Data</button>
                <button id="clearBtn" class="clear-btn">Clear All</button>
            </div>
        </header>
        
        <div class="summary-cards">
            <div class="card balance">
                <h3>CURRENT BALANCE</h3>
                <p id="balanceAmount">0.00</p>
            </div>
            <div class="card income">
                <h3>TOTAL INCOME</h3>
                <p id="incomeAmount">0.00</p>
            </div>
            <div class="card expense">
                <h3>TOTAL EXPENSE</h3>
                <p id="expenseAmount">0.00</p>
            </div>
        </div>
        
        <div class="form-section">
            <h2>Add New Transaction</h2>
            <form id="transactionForm">
                <div class="form-row">
                    <div class="form-group">
                        <label for="date">Date</label>
                        <input type="date" id="date" required>
                    </div>
                    <div class="form-group">
                        <label for="time">Time</label>
                        <input type="time" id="time" required>
                    </div>
                    <div class="form-group">
                        <label for="category">Category</label>
                        <select id="category" required>
                            <option value="">Select Category</option>
                            <option value="Food">Food</option>
                            <option value="Income">Income</option>
                            <option value="Transport">Transport</option>
                            <option value="Shopping">Shopping</option>
                            <option value="Bills">Bills</option>
                            <option value="Entertainment">Entertainment</option>
                            <option value="Healthcare">Healthcare</option>
                            <option value="Other">Other</option>
                        </select>
                    </div>
                </div>
                <div class="form-row">
                    <div class="form-group">
                        <label for="description">Description (optional)</label>
                        <input type="text" id="description" placeholder="Enter description">
                    </div>
                    <div class="form-group">
                        <label for="type">Type</label>
                        <select id="type" required>
                            <option value="">Select Type</option>
                            <option value="In">In (Income)</option>
                            <option value="Out">Out (Expense)</option>
                        </select>
                    </div>
                    <div class="form-group">
                        <label for="cost">Amount</label>
                        <input type="number" id="cost" step="0.01" min="0" required placeholder="0.00">
                    </div>
                </div>
                <button type="submit">Add Transaction</button>
            </form>
        </div>
        
        <div class="history-section">
            <h2>Transaction History</h2>
            <div id="transactionTable">
                <table>
                    <thead>
                        <tr>
                            <th>Date</th>
                            <th>Time</th>
                            <th>Category</th>
                            <th>Description</th>
                            <th>Type</th>
                            <th>Amount</th>
                            <th>Action</th>
                        </tr>
                    </thead>
                    <tbody id="transactionList">
                        <!-- Transactions will be populated here -->
                    </tbody>
                </table>
                <div id="noDataMessage" class="no-data">
                    No transactions yet. Add your first transaction above.
                </div>
            </div>
        </div>
    </div>

    <script>
        // Initialize transactions from localStorage or empty array
        let transactions = JSON.parse(localStorage.getItem('moneyTrackerTransactions')) || [];
        
        // DOM elements
        const transactionForm = document.getElementById('transactionForm');
        const transactionList = document.getElementById('transactionList');
        const noDataMessage = document.getElementById('noDataMessage');
        const balanceAmount = document.getElementById('balanceAmount');
        const incomeAmount = document.getElementById('incomeAmount');
        const expenseAmount = document.getElementById('expenseAmount');
        const exportBtn = document.getElementById('exportBtn');
        const importBtn = document.getElementById('importBtn');
        const clearBtn = document.getElementById('clearBtn');
        
        // Set default date and time to current
        document.getElementById('date').valueAsDate = new Date();
        document.getElementById('time').value = new Date().toTimeString().substring(0, 5);
        
        // Format currency
        function formatCurrency(amount) {
            return new Intl.NumberFormat('en-US', {
                minimumFractionDigits: 2,
                maximumFractionDigits: 2
            }).format(amount);
        }
        
        // Update summary cards
        function updateSummary() {
            let totalIncome = 0;
            let totalExpense = 0;
            
            transactions.forEach(transaction => {
                if (transaction.type === 'In') {
                    totalIncome += parseFloat(transaction.cost);
                } else {
                    totalExpense += parseFloat(transaction.cost);
                }
            });
            
            const balance = totalIncome - totalExpense;
            
            balanceAmount.textContent = formatCurrency(balance);
            incomeAmount.textContent = formatCurrency(totalIncome);
            expenseAmount.textContent = formatCurrency(totalExpense);
        }
        
        // Render transactions table
        function renderTransactions() {
            if (transactions.length === 0) {
                noDataMessage.style.display = 'block';
                transactionList.innerHTML = '';
                return;
            }
            
            noDataMessage.style.display = 'none';
            
            // Sort transactions by date and time (newest first)
            const sortedTransactions = [...transactions].sort((a, b) => {
                const dateA = new Date(`${a.date} ${a.time}`);
                const dateB = new Date(`${b.date} ${b.time}`);
                return dateB - dateA;
            });
            
            transactionList.innerHTML = sortedTransactions.map((transaction, index) => `
                <tr>
                    <td>${transaction.date}</td>
                    <td>${transaction.time}</td>
                    <td>${transaction.category}</td>
                    <td>${transaction.description || '-'}</td>
                    <td class="type-${transaction.type.toLowerCase()}">${transaction.type}</td>
                    <td>${formatCurrency(parseFloat(transaction.cost))}</td>
                    <td>
                        <button class="delete-btn" data-index="${index}">Delete</button>
                    </td>
                </tr>
            `).join('');
            
            // Add event listeners to delete buttons
            document.querySelectorAll('.delete-btn').forEach(button => {
                button.addEventListener('click', function() {
                    const index = parseInt(this.getAttribute('data-index'));
                    deleteTransaction(index);
                });
            });
        }
        
        // Add new transaction
        function addTransaction(event) {
            event.preventDefault();
            
            const date = document.getElementById('date').value;
            const time = document.getElementById('time').value;
            const category = document.getElementById('category').value;
            const description = document.getElementById('description').value;
            const type = document.getElementById('type').value;
            const cost = document.getElementById('cost').value;
            
            const newTransaction = {
                date,
                time,
                category,
                description,
                type,
                cost: parseFloat(cost).toFixed(2)
            };
            
            transactions.push(newTransaction);
            localStorage.setItem('moneyTrackerTransactions', JSON.stringify(transactions));
            
            // Reset form
            transactionForm.reset();
            document.getElementById('date').valueAsDate = new Date();
            document.getElementById('time').value = new Date().toTimeString().substring(0, 5);
            
            updateSummary();
            renderTransactions();
        }
        
        // Delete transaction
        function deleteTransaction(index) {
            if (confirm('Are you sure you want to delete this transaction?')) {
                transactions.splice(index, 1);
                localStorage.setItem('moneyTrackerTransactions', JSON.stringify(transactions));
                updateSummary();
                renderTransactions();
            }
        }
        
        // Export data as CSV
        function exportData() {
            if (transactions.length === 0) {
                alert('No data to export.');
                return;
            }
            
            // Create CSV content
            let csvContent = "Date,Time,Category,Description,Type,Cost\n";
            
            transactions.forEach(transaction => {
                csvContent += `"${transaction.date}","${transaction.time}","${transaction.category}","${transaction.description || ''}","${transaction.type}","${transaction.cost}"\n`;
            });
            
            // Create and download file
            const blob = new Blob([csvContent], { type: 'text/csv' });
            const url = URL.createObjectURL(blob);
            const a = document.createElement('a');
            a.href = url;
            a.download = `money-tracker-${new Date().toISOString().split('T')[0]}.csv`;
            document.body.appendChild(a);
            a.click();
            document.body.removeChild(a);
            URL.revokeObjectURL(url);
        }
        
        // Import data from file
        function importData() {
            const input = document.createElement('input');
            input.type = 'file';
            input.accept = '.csv';
            
            input.onchange = e => {
                const file = e.target.files[0];
                const reader = new FileReader();
                
                reader.onload = function(event) {
                    try {
                        const csvContent = event.target.result;
                        const lines = csvContent.split('\n');
                        const importedTransactions = [];
                        
                        // Skip header row
                        for (let i = 1; i < lines.length; i++) {
                            const line = lines[i].trim();
                            if (!line) continue;
                            
                            // Parse CSV line (handling quoted fields)
                            const values = [];
                            let inQuotes = false;
                            let currentValue = '';
                            
                            for (let j = 0; j < line.length; j++) {
                                const char = line[j];
                                
                                if (char === '"') {
                                    inQuotes = !inQuotes;
                                } else if (char === ',' && !inQuotes) {
                                    values.push(currentValue);
                                    currentValue = '';
                                } else {
                                    currentValue += char;
                                }
                            }
                            
                            values.push(currentValue);
                            
                            if (values.length >= 6) {
                                importedTransactions.push({
                                    date: values[0],
                                    time: values[1],
                                    category: values[2],
                                    description: values[3],
                                    type: values[4],
                                    cost: values[5]
                                });
                            }
                        }
                        
                        if (importedTransactions.length > 0) {
                            if (confirm(`Import ${importedTransactions.length} transactions? This will replace your current data.`)) {
                                transactions = importedTransactions;
                                localStorage.setItem('moneyTrackerTransactions', JSON.stringify(transactions));
                                updateSummary();
                                renderTransactions();
                                alert('Data imported successfully!');
                            }
                        } else {
                            alert('No valid transactions found in the file.');
                        }
                    } catch (error) {
                        alert('Error importing data. Please check the file format.');
                        console.error(error);
                    }
                };
                
                reader.readAsText(file);
            };
            
            input.click();
        }
        
        // Clear all data
        function clearAllData() {
            if (confirm('Are you sure you want to clear all transactions? This cannot be undone.')) {
                transactions = [];
                localStorage.removeItem('moneyTrackerTransactions');
                updateSummary();
                renderTransactions();
            }
        }
        
        // Event listeners
        transactionForm.addEventListener('submit', addTransaction);
        exportBtn.addEventListener('click', exportData);
        importBtn.addEventListener('click', importData);
        clearBtn.addEventListener('click', clearAllData);
        
        // Initial render
        updateSummary();
        renderTransactions();
    </script>
</body>
</html>
